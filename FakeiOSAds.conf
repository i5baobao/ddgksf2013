hostname = app.dsx.ac

####################################
# juzhi 过滤 config.(ad/search/recommend)
####################################
^http:\/\/[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+){1,4}(:\d+)?\/api\/v\d\/config\/getConfigList\.do url script-response-body

script-response-body = {
    let body = $response.body;
    if (!body) { $done({}); }

    try {
        let json = JSON.parse(body);

        if (json.data && Array.isArray(json.data)) {
            json.data = json.data.filter(item => {
                if (!item.keyName) return true;
                return !/^config\.(ad|search|recommend)$/.test(item.keyName);
            });
        }

        $done({ body: JSON.stringify(json) });
    } catch(e) {
        console.log("getConfigList parse error:", e);
        $done({ body });
    }
}

####################################
# common reject
####################################
^http:\/\/[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+){1,4}(:\d+)?\/.*?\/v\d\/(version|notice\?|top_notice\?|advert\?position=[^2]+) url reject-200
